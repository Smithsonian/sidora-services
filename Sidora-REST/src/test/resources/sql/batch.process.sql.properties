#
# Copyright 2015-2016 Smithsonian Institution.
#
# Licensed under the Apache License, Version 2.0 (the "License"); you may not
# use this file except in compliance with the License.You may obtain a copy of
# the License at: http://www.apache.org/licenses/
#
# This software and accompanying documentation is supplied without
# warranty of any kind. The copyright holder and the Smithsonian Institution:
# (1) expressly disclaim any warranties, express or implied, including but not
# limited to any implied warranties of merchantability, fitness for a
# particular purpose, title or non-infringement; (2) do not assume any legal
# liability or responsibility for the accuracy, completeness, or usefulness of
# the software; (3) do not represent that use of the software would not
# infringe privately owned rights; (4) do not warrant that the software
# is error-free or will be maintained, supported, updated or enhanced;
# (5) will not be liable for any indirect, incidental, consequential special
# or punitive damages of any kind or nature, including but not limited to lost
# profits or loss of data, on any basis arising from contract, tort or
# otherwise, even if any of the parties has been warned of the possibility of
# such loss or damage.
#
# This distribution includes several third-party libraries, each with their own
# license terms. For a complete copy of all copyright and license terms, including
# those of third-party libraries, please see the product release notes.
#
####################################################################################
## notice we use named parameters in the queries, eg :#name.
## A named query parameter must start with :#
####################################################################################


## sql that insert new batch requests
sql.insertNewBatchRequest=INSERT INTO camelBatch.camelBatchRequests (correlationId, parentId, resourceFileList, resourceXML, ds_metadata, ds_sidora, contentModel, resourceOwner, titleField, codebookPID, resourceCount) VALUES(:#correlationId, :#parentId, :#resourceFileList, :#resourceXML, :#ds_metadata, :#ds_sidora, :#contentModel, :#resourceOwner, :#titleField, :#codebookPID, :#resourceCount)

## sql that inserts resources for the batch request
sql.insertResources=INSERT INTO camelBatch.camelBatchResources (correlationId, resourceFile, parentId, contentModel, resourceOwner, created_date, updated_date) VALUES(:#correlationId, :#resourceFile, :#parentId, :#contentModel, :#resourceOwner, null, null)

## sql that updates the Batch Process Request resourceCount
sql.updateBatchResourceCount=update camelBatchRequests set resourceCount = :#resourceCount where correlationId = :#correlationId

## sql that select all unprocessed Batch Processes
sql.selectBatchProcess=select * from camelBatchRequests where complete = false

## sql that select all unprocessed Batch Processes
sql.selectResources=select resourceFile from camelBatchResources where (complete = false AND correlationId = :#correlationId)

## sql that updates the Batch Process Request processCount
sql.updateBatchProcessCount=update camelBatchRequests set processCount = :#processCount where correlationId = :#correlationId

## sql that update the NewBatchProcessRequest as complete
sql.markBatchProcessComplete=update camelBatchRequests set complete = true where correlationId = :#correlationId

## sql that select all unprocessed Batch Processes
sql.checkBatchRequestStatus=select * from camelBatchRequests where correlationId = :#correlationId



## sql that creates two table for the batch process
# MySQL 5.7
############################################################################

#sql.createBatchProcessRequestTable=CREATE TABLE IF NOT EXISTS camelBatch.camelBatchRequests (correlationId CHAR(36) NOT NULL, parentId TEXT NOT NULL, resourceFileList TEXT NOT NULL, resourceXML TEXT NOT NULL, ds_metadata TEXT NOT NULL, ds_sidora TEXT NOT NULL, contentModel TEXT NOT NULL, resourceOwner TEXT NOT NULL, titleField TEXT NOT NULL, codebookPID TEXT DEFAULT NULL, resourceCount INT(10) NULL, processCount INT(10) NOT NULL DEFAULT 0, complete BOOLEAN NOT NULL DEFAULT false, created TIMESTAMP DEFAULT CURRENT_TIMESTAMP, updated DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, PRIMARY KEY (correlationId));

#sql.createBatchResourceFilesTable=CREATE TABLE IF NOT EXISTS camelBatch.camelBatchResources (correlationId CHAR(36) NOT NULL, resourceFile TEXT NOT NULL, parentId TEXT NOT NULL, pid TEXT DEFAULT NULL, contentModel TEXT NOT NULL, resourceOwner TEXT NOT NULL, titleField TEXT DEFAULT NULL, ds_created BOOLEAN NOT NULL DEFAULT false, complete BOOLEAN NOT NULL DEFAULT 0, created_date TIMESTAMP DEFAULT CURRENT_TIMESTAMP, updated_date DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP);

## sql that creates two table for the batch process
# MySQL 5.1 has issues with two columns with "DEFAULT CURRENT_TIMESTAMP"
############################################################################

sql.createBatchProcessRequestTable=CREATE TABLE IF NOT EXISTS camelBatch.camelBatchRequests (correlationId CHAR(36) NOT NULL, parentId TEXT NOT NULL, resourceFileList TEXT NOT NULL, resourceXML TEXT NOT NULL, ds_metadata TEXT NOT NULL, ds_sidora TEXT NOT NULL, contentModel TEXT NOT NULL, resourceOwner TEXT NOT NULL, titleField TEXT NOT NULL, codebookPID TEXT DEFAULT NULL, resourceCount INT(10) NULL, processCount INT(10) NOT NULL DEFAULT 0, complete BOOLEAN NOT NULL DEFAULT false, created TIMESTAMP DEFAULT '0000-00-00 00:00:00', updated TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, PRIMARY KEY (correlationId));

sql.createBatchResourceFilesTable=CREATE TABLE IF NOT EXISTS camelBatch.camelBatchResources (correlationId CHAR(36) NOT NULL, resourceFile TEXT NOT NULL, parentId TEXT NOT NULL, pid TEXT DEFAULT NULL, contentModel TEXT NOT NULL, resourceOwner TEXT NOT NULL, titleField TEXT DEFAULT NULL, ds_created BOOLEAN NOT NULL DEFAULT false, complete BOOLEAN NOT NULL DEFAULT false, created_date TIMESTAMP DEFAULT '0000-00-00 00:00:00', updated_date TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP);